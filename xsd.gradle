apply plugin: 'com.github.jacobono.jaxb'

dependencies {
    jaxb 'com.sun.xml.bind:jaxb-xjc:2.2.7-b41'
    jaxb 'com.sun.xml.bind:jaxb-impl:2.2.7-b41'
    jaxb 'javax.xml.bind:jaxb-api:2.2.7'
}

def xsdResourcesDir = 'src/main/resources/schema'

import groovy.io.FileType
def downloadXsd(file) {
  def fileName = new File(file).getName()
  def common = new File("${xsdResourcesDir}/${fileName}")
  new URL(file).withInputStream { i ->
      common.withOutputStream {
          it << i
      }
  }
}

task(setXjcProperties) << {
  System.setProperty('javax.xml.accessExternalSchema', 'all')
}

jaxb {
    xsdDir = xsdResourcesDir
    xjc {
        args = ['-disableXmlSecurity', '-b', 'jaxb-bindings.xml']
    }
}

xjc.dependsOn setXjcProperties
